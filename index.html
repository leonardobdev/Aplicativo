<!DOCTYPE html>
<html lang="en">

<head>
	<title>Snake</title>
	<meta charset="UTF-8">
	<meta name="theme-color" content="#ee6e73">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, interactive-widget=resizes-content, viewport-fit=cover">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="description" content="Snake">
	<link rel="canonical" href="https://leonardobdev.github.io/Snake/">
	<link rel="shortcut icon" href="/Snake/src/img/favicon.ico" type="image/x-icon">
	<link rel="icon" type="image/gif" href="/Snake/src/img/animated_favicon1.gif">
	<script src="/Snake/js/materialize.min.js"></script>
	<link rel="stylesheet" href="/Snake/css/materialize.min.css">
	<link href="/Snake/material-icons/iconfont/material-icons.css" rel="stylesheet">
	<link rel="manifest" href="/Snake/manifest.json" crossorigin="use-credentials">
	<script>
		document.addEventListener('DOMContentLoaded', function () {
			var elem = document.querySelector('.sidenav');
			M.Sidenav.init(elem);
			var instance = M.Sidenav.getInstance(elem);
			var themeSwitch1 = document.getElementById("themeSwitch1");
			var themeSwitch2 = document.getElementById("themeSwitch2");
			themeSwitch1.onchange = () => {
				document.body.classList.toggle("dark-theme");
				themeSwitch2.querySelector("input").checked = !themeSwitch2.querySelector("input").checked;
			};
			themeSwitch2.onchange = () => {
				document.body.classList.toggle("dark-theme");
				themeSwitch1.querySelector("input").checked = !themeSwitch1.querySelector("input").checked;
			};

			var canvas = document.querySelector("canvas");
			var cx = canvas.getContext("2d");

			var cv = {};

			cv.w = 320;
			cv.h = 320;

			canvas.width = cv.w;
			canvas.height = cv.h;

			var p = {};

			p.w = 20;
			p.h = 20;
			p.x = cv.w / 2;
			p.y = cv.h / 2;
			p.vx = 0;
			p.vy = 0;
			p.b = [];

			var sx = 0;
			var sy = 0;
			var mx = 0;
			var my = 0;
			var dx = 0;
			var dy = 0;

			var f = {};
			f.w = 20;
			f.h = 20;
			f.x = 0;
			f.y = 0;

			function s() {
				cx.fillRect(p.x, p.y, p.w, p.h);
				gf();
			}

			function l() {
				if (p.x + p.vx >= 0 && p.y + p.vy >= 0 && p.x + p.w + p.vx <= cv.w && p.y + p.h + p.vy <= cv.h) {
					p.x += p.vx;
					p.y += p.vy;
					if (p.b[0] != undefined) {
						let bvx = p.vx;
						let bvy = p.vy;
						let ovx = p.vx;
						let ovy = p.vy;
						for (let i = 0; i < p.b.length; i++) {
							p.b[i].x += p.b[i].vx;
							p.b[i].y += p.b[i].vy;
							ovx = p.b[i].vx;
							ovy = p.b[i].vy;
							p.b[i].vx = bvx;
							p.b[i].vy = bvy;
							bvx = ovx;
							bvy = ovy;
						}
					}
				}
				if (p.x == f.x && p.y == f.y) {
					gf();
					if (p.b[0] == undefined) {
						p.b.push({
							x: p.x,
							y: p.y,
							vx: 0,
							vy: 0
						});
					} else {
						p.b.push({
							x: p.b[p.b.length - 1].x,
							y: p.b[p.b.length - 1].y,
							vx: 0,
							vy: 0
						});
					}
				}
				cx.clearRect(0, 0, cv.w, cv.h);
				cx.fillStyle = "black";
				cx.fillRect(0, 0, cv.w, cv.h);
				cx.fillStyle = "limegreen";
				cx.fillRect(p.x, p.y, p.w, p.h);
				if (p.b[0] != undefined) {
					for (let i = 0; i < p.b.length; i++) {
						cx.fillRect(p.b[i].x, p.b[i].y, p.w, p.h);
					}
				}
				cx.fillStyle = "red";
				cx.fillRect(f.x, f.y, f.w, f.h);
				setTimeout(l, 1000);
			}

			canvas.ontouchstart = function (e) {
				let t = e.touches[e.touches.length - 1];
				let cr = canvas.getBoundingClientRect();
				sx = t.pageX - cr.left;
				sy = t.pageY - cr.top;
			};
			canvas.ontouchmove = function (e) {
				let t = e.touches[e.touches.length - 1];
				let cr = canvas.getBoundingClientRect();
				mx = t.pageX - cr.left;
				my = t.pageY - cr.top;
				dx = 0;
				dy = 0;
				dx = mx > sx ? mx - sx : dx;
				dx = mx < sx ? mx + sx : dx;
				dy = my > sy ? my - sy : dy;
				dy = my < sy ? my + sy : dy;
				if (dx > dy) {
					if (mx > sx && p.vx != -20) {
						p.vx = 20;
						p.vy = 0;
					}
					if (mx < sx && p.vx != 20) {
						p.vx = -20;
						p.vy = 0;
					}
				}
				if (dx < dy) {
					if (my > sy && p.vy != -20) {
						p.vx = 0;
						p.vy = 20;
					}
					if (my < sy && p.vy != 20) {
						p.vx = 0;
						p.vy = -20;
					}
				}
			};
			window.onkeyup = function (e) {
				switch (e.key) {
					case "ArrowRight":
						p.vx = 20;
						p.vy = 0;
						break;
					case "ArrowLeft":
						p.vx = -20;
						p.vy = 0;
						break;
					case "ArrowDown":
						p.vx = 0;
						p.vy = 20;
						break;
					case "ArrowUp":
						p.vx = 0;
						p.vy = -20;
						break;
				}
			}

			function gf() {
				do {
					f.x = getRandomInt(1, 15) * 20;
					f.y = getRandomInt(1, 15) * 20;
				} while (f.x == p.x && f.y == p.y);
			}

			function getRandomInt(min, max) {
				min = Math.ceil(min);
				max = Math.floor(max);
				return Math.floor(Math.random() * (max - min) + min);
			};

			s();
			l();

		});

		document.addEventListener('keydown', (e) => {
			e = e || window.event;
			if (e.keyCode == 116) {
				e.preventDefault();
			}
		});

	</script>
	<style>
		html,
		body {
			height: 100vh;
			width: 100vw;
			background: white;
			overscroll-behavior-y: contain;
		}

		canvas {
			width: 320px;
			height: 320px;
			border: 1px solid black;
			display: flex;
			margin-left: auto;
			margin-right: auto;
		}

		.brand-logo {
			color: black !important;
		}

		body.dark-theme,
		.dark-theme ul.sidenav,
		.dark-theme ul.sidenav a,
		.dark-theme ul.sidenav a i {
			background: black !important;
			color: white !important;
		}

		.dark-theme canvas {
			border: 1px solid white !important;
		}
	</style>
</head>

<body>

	<nav>
		<div class="nav-wrapper">
			<a href="#" class="brand-logo">Snake</a>
			<a href="#" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons">menu</i></a>
			<ul class="right hide-on-med-and-down">
				<li>
					<nav>
						<div class="nav-wrapper">
							<form id="search1">
								<div class="input-field">
									<input id="searchOne" type="search" required>
									<label class="label-icon" for="searchOne"><i
											class="material-icons">search</i></label>
									<i class="material-icons">close</i>
								</div>
							</form>
						</div>
					</nav>
				</li>
				<li><a href="#"><i class="material-icons">home</i></a></li>
				<li>
					<div class="switch" id="themeSwitch1">
						Dark Mode
						<label for="cb1">
							<input type="checkbox" id="cb1">
							<span class="lever"></span>
						</label>
					</div>
				</li>
			</ul>
		</div>
	</nav>

	<ul class="sidenav" id="mobile-demo">
		<li>
			<nav>
				<div class="nav-wrapper">
					<form id="search2">
						<div class="input-field">
							<input id="searchTwo" type="search" required>
							<label class="label-icon" for="searchTwo"><i class="material-icons">search</i></label>
							<i class="material-icons">close</i>
						</div>
					</form>
				</div>
			</nav>
		</li>
		<li><a href="#"><i class="material-icons">home</i>Home</a></li>
		<li><a href="#">
				<i class="material-icons">brightness_4</i>
				<div class="switch" id="themeSwitch2">
					Dark Mode
					<label for="cb2">
						<input type="checkbox" id="cb2">
						<span class="lever"></span>
					</label>
				</div>
			</a>
		</li>
	</ul>

	<br>
	<br>
	<br>
	<br>
	<br>

	<canvas></canvas>
</body>

<script src="/Snake/app.js"></script>

</html>